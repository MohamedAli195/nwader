import{z as D,a as v,r as p,j as e,I as f,B as w,S as g,A as O,D as E,T as q,d as H,e as N,f as u,g as M,P as U,M as k,E as I,C as R}from"./index-De2xroJ3.js";function L({tempCat:r,onCloseUp:l}){const[d,{isLoading:o}]=D(),{register:s,handleSubmit:b,setValue:t,formState:{errors:i}}=v();p.useEffect(()=>{r&&(t("name",r.name),t("phone",r.phone))},[r,t]);const x=async n=>{var m,y;const h=new FormData;h.append("name",n.name),h.append("phone",n.phone);try{await d({id:Number(r==null?void 0:r.id),body:{name:n.name,phone:n.phone}}).unwrap(),g.fire("Success","تم التعديل بنجاح","success"),l()}catch(c){console.log(c);const j=c;g.fire("Error",(y=(m=j==null?void 0:j.data)==null?void 0:m.errors)!=null&&y.name?j.data.errors.name.join(`
`):"Something went wrong","error")}l()};return e.jsxs("form",{className:"flex justify-center  flex-col my-12 gap-2 p-5 w-full ",onSubmit:b(x),children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"اسم المرحلة الدراسية"}),e.jsx(f,{type:"text",...s("name",{required:"حقل الاسم مطلوب"})}),i.name&&e.jsx("p",{className:"text-red-500 text-sm",children:i.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"الهاتف"}),e.jsx(f,{type:"text",...s("phone",{required:"حقل الهاتف مطلوب"})}),i.phone&&e.jsx("p",{className:"text-red-500 text-sm",children:i.phone.message})]}),e.jsx("div",{children:e.jsx(w,{className:"w-full text-3xl",disabled:o,children:o?"انتظر...":"تحديث"})})]})}function P(){var S;const[r,l]=p.useState(1),[d,o]=p.useState(""),{data:s,error:b,isLoading:t}=O({page:r,search:d}),[i,x]=p.useState(!1),[n,h]=p.useState(),m=()=>x(!1),y=()=>x(!0),c=(s==null?void 0:s.data)??[],j=((S=s==null?void 0:s.meta)==null?void 0:S.total)??0,[A]=E(),F=async a=>{if((await g.fire({title:"هل أنت متأكد؟",text:"لن تتمكن من التراجع عن هذا!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#2563eb",cancelButtonColor:"#dc2626",confirmButtonText:"نعم، احذف",cancelButtonText:"إلغاء",buttonsStyling:!0,reverseButtons:!0})).isConfirmed)try{await A(a).unwrap(),g.fire("تم الحذف!","تم حذف الطالب بنجاح.","success")}catch(C){g.fire("خطأ",`حدث خطأ ما! ${C} `,"error")}},T=p.useRef(null),B=a=>{o(a.target.value)};return t?e.jsx("p",{children:"جاري تحميل البيانات..."}):b?e.jsx("p",{className:"text-red-500",children:"حدث خطأ أثناء جلب البيانات!"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white shadow-md dark:border-gray-700 dark:bg-gray-900",children:[e.jsx("div",{className:"w-full p-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:e.jsx("input",{value:d,onChange:B,ref:T,type:"text",placeholder:"ابحث هنا...",className:`h-11 w-full rounded-lg border border-gray-300 bg-white px-4 text-sm text-gray-800 shadow-sm placeholder:text-gray-400 \r
              focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 \r
              dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-400`})}),e.jsx("div",{className:"max-w-full overflow-x-auto",children:e.jsxs(q,{children:[e.jsx(H,{children:e.jsxs(N,{className:"bg-gray-50 dark:bg-gray-800",children:[e.jsx(u,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"اسم الطالب"}),e.jsx(u,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"رقم الهاتف"}),e.jsx(u,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"تاريخ التسجيل"}),e.jsx(u,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-center text-sm dark:text-gray-300",children:"الإجراءات"})]})}),e.jsx(M,{className:"divide-y divide-gray-100 dark:divide-gray-700",children:c.map(a=>e.jsxs(N,{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition",children:[e.jsx(u,{className:"px-5 py-4 text-start text-gray-900 dark:text-gray-100 font-medium",children:a.name}),e.jsx(u,{className:"px-5 py-4 text-gray-600 dark:text-gray-400 text-start",children:a.phone}),e.jsx(u,{className:"px-5 py-4 text-gray-600 dark:text-gray-400 text-start",children:a.registered_at}),e.jsxs(u,{className:"px-5 py-4 text-center space-x-2",children:[e.jsx(w,{className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-lg",onClick:()=>{y(),h(a)},children:"تعديل"}),e.jsx(w,{className:"bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg mx-1",onClick:()=>F(a==null?void 0:a.id),children:"حذف"})]})]},a.id))})]})}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:e.jsx(U,{page:r,SetPage:l,total:j})})]}),e.jsxs(k,{className:"w-full lg:w-4/12 xl:w-4/12 h-auto relative rounded-2xl bg-white dark:bg-gray-900",isOpen:i,onClose:m,children:[e.jsx("h1",{className:"flex justify-center p-3 text-2xl font-semibold text-gray-700 dark:text-gray-200",children:"تعديل الطالب"}),e.jsx(L,{onCloseUp:m,tempCat:n})]})]})}function z({onClose:r}){const[l,{data:d,isLoading:o}]=I(),{register:s,handleSubmit:b,formState:{errors:t}}=v(),i=async x=>{var h,m;const n=new FormData;n.append("name",x.name),n.append("phone",x.phone),n.append("password",x.password);try{await l(n).unwrap(),g.fire("تم ","تم بنجاح","success")}catch(y){const c=y;g.fire("Error",(m=(h=c==null?void 0:c.data)==null?void 0:h.errors)!=null&&m.name?c.data.errors.name.join(`
`):"Something went wrong","error")}r()};return e.jsxs("form",{className:"flex justify-center  flex-col my-12 gap-2 p-5 w-full ",onSubmit:b(i),children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"اسم الطالب"}),e.jsx(f,{type:"text",...s("name",{required:"حقل الاسم مطلوب"})}),t.name&&e.jsx("p",{className:"text-red-500 text-sm",children:t.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"الهاتف"}),e.jsx(f,{type:"text",...s("phone",{required:"حقل الاسم مطلوب"})}),t.phone&&e.jsx("p",{className:"text-red-500 text-sm",children:t.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"الباسورد"}),e.jsx(f,{type:"text",...s("password",{required:"حقل الاسم مطلوب"})}),t.password&&e.jsx("p",{className:"text-red-500 text-sm",children:t.password.message})]}),e.jsx("div",{children:e.jsx(w,{className:"w-full text-3xl",disabled:o,children:o?"انتظر...":" اضافة طالب"})}),d&&e.jsx("p",{style:{color:"green"},children:"Student added successfully!"})]})}const V=()=>{const[r,l]=p.useState(!1),d=()=>{l(!1)},o=()=>{l(!0)};return e.jsxs(R,{onOpen:o,title:"academic-stages",children:[e.jsx(P,{}),e.jsxs(k,{className:"w-full  lg:w-4/12 xl:w-4/12  h-auto relative  rounded-3xl bg-white  dark:bg-gray-900",isOpen:r,onClose:d,children:[e.jsx("h1",{className:"flex justify-center p-3  text-3xl",children:"المراحل الدراسية"}),e.jsx(z,{onClose:d})]})]})};export{V as default};
