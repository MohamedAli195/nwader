import{r as m,v as U,q as B,a as L,j as e,I as O,k as F,l as D,B as v,S as f,w as $,x as E,T as H,d as I,e as T,f as y,g as R,P as Y,M,y as q,C as P}from"./index-De2xroJ3.js";function G({tempCat:r,onCloseUp:l}){const[i,o]=m.useState((r==null?void 0:r.academic_year)??null),[d,{isLoading:w}]=U(),{data:u,isLoading:N}=B({search:"",page:1}),x=((u==null?void 0:u.data)??[]).map(s=>({value:s.id??0,label:s.name,data:s}))||[],h=r==null?void 0:r.name,g=(h==null?void 0:h.split(" - ")[0])??"",{register:k,handleSubmit:b,setValue:p,control:c,formState:{errors:a}}=L();m.useEffect(()=>{var s;r&&(p("name",g),p("academic_year_id",((s=r.academic_year)==null?void 0:s.id)??null))},[r,p,g]);const j=async s=>{var t,A;const n=new FormData;n.append("name",s.name),n.append("academic_year_id",String(s.academic_year_id));try{await d({id:Number(r==null?void 0:r.id),body:{name:`${s.name} - ${i==null?void 0:i.name}`,academic_year_id:s.academic_year_id}}).unwrap(),f.fire("Success","Update Classe Successfully!","success"),l()}catch(_){console.log(_);const C=_;f.fire("Error",(A=(t=C==null?void 0:C.data)==null?void 0:t.errors)!=null&&A.name?C.data.errors.name.join(`
`):"Something went wrong","error")}l()};return e.jsxs("form",{className:"flex justify-center  flex-col my-12 gap-2 p-5 w-full ",onSubmit:b(j),children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"اسم المادة"}),e.jsx(O,{type:"text",...k("name",{required:"حقل الاسم مطلوب"})}),a.name&&e.jsx("p",{className:"text-red-500 text-sm",children:a.name.message})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("label",{className:"block mb-1",children:"اسم الصف التعليمى"}),e.jsx(F,{control:c,name:"academic_year_id",render:({field:s})=>e.jsx(D,{...s,options:x,isClearable:!0,className:"w-auto",isLoading:N,placeholder:"اسم الصف",onChange:n=>{s.onChange((n==null?void 0:n.value)??null),o((n==null?void 0:n.data)??null)},value:x.find(n=>n.value==s.value)??null})})]}),e.jsx("div",{children:e.jsx(v,{className:"w-full text-3xl",disabled:w,children:w?"انتظر...":" تعديل  المادة"})})]})}function Q(){var n;const[r,l]=m.useState(1),[i,o]=m.useState(""),{data:d,error:w,isLoading:u}=$({page:r,search:i}),[N,S]=m.useState(!1),[x,h]=m.useState(),g=()=>S(!1),k=()=>S(!0),b=(d==null?void 0:d.data)??[],p=((n=d==null?void 0:d.meta)==null?void 0:n.total)??0,[c]=E(),a=async t=>{if((await f.fire({title:"هل أنت متأكد؟",text:"لن تتمكن من التراجع عن هذا!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"نعم، احذف",cancelButtonText:"إلغاء",buttonsStyling:!0,reverseButtons:!0})).isConfirmed)try{await c(t).unwrap(),f.fire("تم الحذف!","تم الحذف بنجاح.","success")}catch(_){f.fire("خطأ",`حدث خطأ ما! ${_} `,"error")}},j=m.useRef(null),s=t=>{o(t.target.value)};return u?e.jsx("p",{children:"جاري تحميل البيانات..."}):w?e.jsx("p",{className:"text-red-500",children:"حدث خطأ أثناء جلب البيانات!"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm dark:border-white/[0.05] dark:bg-white/[0.03]",children:[e.jsx("div",{className:"w-full my-5 px-4",children:e.jsx("input",{value:i,onChange:s,ref:j,type:"text",placeholder:"ابحث هنا ...",className:"dark:bg-dark-900 h-11 w-full text-center rounded-lg border border-gray-200 bg-transparent py-2.5 text-sm text-gray-800 shadow-sm placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white dark:placeholder:text-white/40 dark:focus:border-brand-600"})}),e.jsxs("div",{className:"max-w-full overflow-x-auto",children:[e.jsxs(H,{children:[e.jsx(I,{className:"border-b border-gray-100 dark:border-white/[0.05] bg-gray-50 dark:bg-gray-800/30",children:e.jsxs(T,{children:[e.jsx(y,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"اسم المادة"}),e.jsx(y,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"اسم الصف الدراسى"}),e.jsx(y,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-center text-sm dark:text-gray-300",children:"الإجراءات"})]})}),e.jsx(R,{className:"divide-y divide-gray-100 dark:divide-white/[0.05]",children:b.map(t=>e.jsxs(T,{className:"hover:bg-gray-50 dark:hover:bg-gray-800/40 transition",children:[e.jsx(y,{className:"px-5 py-3 font-medium text-gray-800 dark:text-white/90",children:t.name}),e.jsx(y,{className:"px-4 py-3 text-gray-500 text-start text-sm dark:text-gray-400",children:t.academic_year.name}),e.jsx(y,{className:"px-4 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(v,{className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-lg",onClick:()=>{k(),h(t)},children:"تعديل"}),e.jsx(v,{className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-lg",onClick:()=>a(t==null?void 0:t.id),children:"حذف"})]})})]},t.id))})]}),e.jsx(Y,{page:r,SetPage:l,total:p})]})]}),e.jsxs(M,{className:"w-full lg:w-4/12 xl:w-4/12 h-auto relative rounded-3xl bg-white dark:bg-gray-900",isOpen:N,onClose:g,children:[e.jsx("h1",{className:"flex justify-center p-3 text-2xl font-semibold",children:"تعديل المادة"}),e.jsx(G,{onCloseUp:g,tempCat:x})]})]})}function V({onClose:r}){const[l,i]=m.useState(null),{data:o,isLoading:d}=B({search:"",page:1}),u=((o==null?void 0:o.data)??[]).map(c=>{var a;return{value:((a=c.id)==null?void 0:a.toString())||"",label:c.name,data:c}})||[],[N,{data:S,isLoading:x}]=q(),{register:h,handleSubmit:g,control:k,formState:{errors:b}}=L(),p=async c=>{var j,s;const a=new FormData;a.append("name",`${c.name} - ${l==null?void 0:l.name}`),a.append("academic_year_id",String(c.academic_year_id));try{await N(a).unwrap(),f.fire("تم ","تم بنجاح","success")}catch(n){const t=n;f.fire("Error",(s=(j=t==null?void 0:t.data)==null?void 0:j.errors)!=null&&s.name?t.data.errors.name.join(`
`):"Something went wrong","error")}r()};return e.jsxs("form",{className:"flex justify-center  flex-col my-12 gap-2 p-5 w-full ",onSubmit:g(p),children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"اسم المادة"}),e.jsx(O,{type:"text",...h("name",{required:"حقل الاسم مطلوب"})}),b.name&&e.jsx("p",{className:"text-red-500 text-sm",children:b.name.message})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("label",{className:"block mb-1",children:"اسم الص الدراسي"}),e.jsx(F,{control:k,name:"academic_year_id",render:({field:c})=>e.jsx(D,{...c,options:u,isClearable:!0,className:"w-auto",isLoading:d,placeholder:"اسم الصف التعليمى",onChange:a=>{c.onChange((a==null?void 0:a.value)??null),i((a==null?void 0:a.data)??null)},value:u.find(a=>a.value===c.value)})})]}),e.jsx("div",{children:e.jsx(v,{className:"w-full text-3xl",disabled:x,children:x?"انتظر...":" اضافة مادة"})}),S&&e.jsx("p",{style:{color:"green"},children:"Classes added successfully!"})]})}const J=()=>{const[r,l]=m.useState(!1),i=()=>{l(!1)},o=()=>{l(!0)};return e.jsxs(P,{onOpen:o,title:"academic-year",children:[e.jsx(Q,{}),e.jsxs(M,{className:"w-full  lg:w-4/12 xl:w-4/12  h-auto relative  rounded-3xl bg-white  dark:bg-gray-900",isOpen:r,onClose:i,children:[e.jsx("h1",{className:"flex justify-center p-3  text-3xl",children:"المادة"}),e.jsx(V,{onClose:i})]})]})};export{J as default};
