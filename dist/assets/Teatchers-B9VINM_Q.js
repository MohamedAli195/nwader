import{a3 as se,a as O,r as y,j as e,I as s,B as _,S as f,W as re,a4 as le,w as ie,a5 as ae,a6 as te,T as ne,d as oe,e as U,f as h,g as de,P as ce,M as T,k as C,l as F,a7 as xe,C as pe}from"./index-De2xroJ3.js";function he({tempCat:r,onCloseUp:g}){const[u,{isLoading:c}]=se();console.log(r);const{register:t,handleSubmit:v,setValue:n,watch:w,formState:{errors:m}}=O();y.useEffect(()=>{r&&(n("name",r.name||""),n("phone",r.phone||""),n("current_workplace",r.profile.workplace||""),n("specialization",r.profile.specialization||""),n("work_title",r.profile.title||""),n("phone2",r.profile.phone2||""),n("home_address",r.profile.home_address||""),n("work_address",r.profile.work_address||""),n("country",r.profile.country||""),n("city",r.profile.city||""),n("district",r.profile.district||""),n("desc",r.profile.description||""),n("years_of_experience",r.profile.experience_years),n("national_id_egypt",r.profile.national_id_egypt||""),n("residence_number_outside_egypt",r.profile.residence_number_outside_egypt||""),n("is_online",r.availability.online),n("is_offline",r.availability.offline),n("home_availability",r.availability.at_home))},[n,r]);const i=!!w("is_offline");console.log(i);const o=async a=>{var p;console.log(a);const d=new FormData;d.append("name",a.name),d.append("phone",a.phone||""),a.password&&d.append("password",a.password),d.append("current_workplace",a.current_workplace||""),d.append("specialization",a.specialization),d.append("work_title",a.work_title||""),d.append("phone2",a.phone2||""),d.append("home_address",a.home_address||""),d.append("work_address",a.work_address||""),d.append("country",a.country||""),d.append("city",a.city||""),d.append("district",a.district||""),d.append("desc",a.desc||""),d.append("years_of_experience",String(a.years_of_experience||0)),d.append("national_id_egypt",a.national_id_egypt||""),d.append("residence_number_outside_egypt",a.residence_number_outside_egypt||""),d.append("is_online",a.is_online==="true"?"1":"0"),d.append("is_offline",a.is_offline==="true"?"1":"0"),a.is_offline==="true"?d.append("home_availability",a.home_availability?"1":"0"):d.append("home_availability",a.home_availability="0"),a.image&&a.image[0]&&d.append("image",a.image[0]);try{await u({id:Number(r==null?void 0:r.id),body:d}).unwrap(),f.fire("تم","تم تحديث بيانات المعلم بنجاح","success"),g()}catch(b){const j=b;console.log(j);let N="حدث خطأ ما";(p=j==null?void 0:j.data)!=null&&p.errors&&(typeof j.data.errors=="object"?N=Object.values(j.data.errors).flat().join(`
`):typeof j.data.errors=="string"&&(N=j.data.errors)),g(),f.fire("خطأ",N,"error")}};return e.jsx("div",{className:"max-h-[80vh] overflow-y-auto p-6 rounded-2xl bg-white dark:bg-gray-900 w-full max-w-3xl mx-auto",children:e.jsxs("form",{onSubmit:v(o),className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{children:"الاسم"}),e.jsx(s,{type:"text",...t("name",{required:"الاسم مطلوب"})}),m.name&&e.jsx("p",{className:"text-red-500 text-sm",children:m.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"رقم الهاتف"}),e.jsx(s,{type:"text",...t("phone",{required:"رقم المحمول مطلوب"})}),m.phone&&e.jsx("p",{className:"text-red-500 text-sm",children:m.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"كلمة المرور"}),e.jsx(s,{type:"password",...t("password")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"جهة العمل الحالية"}),e.jsx(s,{type:"text",...t("current_workplace")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"التخصص"}),e.jsx(s,{type:"text",...t("specialization")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"المسمى الوظيفي"}),e.jsx(s,{type:"text",...t("work_title")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"هاتف إضافي"}),e.jsx(s,{type:"text",...t("phone2")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"عنوان السكن"}),e.jsx(s,{type:"text",...t("home_address")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"عنوان العمل"}),e.jsx(s,{type:"text",...t("work_address")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"الدولة"}),e.jsx(s,{type:"text",...t("country")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"المدينة"}),e.jsx(s,{type:"text",...t("city")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"الحى"}),e.jsx(s,{type:"text",...t("district")})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{children:"الوصف"}),e.jsx(s,{className:"h-24",type:"text",...t("desc")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"سنوات الخبرة"}),e.jsx(s,{type:"number",...t("years_of_experience")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"الرقم القومي (للمصريين)"}),e.jsx(s,{type:"text",...t("national_id_egypt",{required:"الرقم القومي مطلوب",pattern:{value:/^\d{14,}$/,message:"الرقم القومي يجب أن يكون 14 رقمًا أو أكثر"}})}),m.national_id_egypt&&e.jsx("p",{className:"text-red-500 text-sm",children:m.national_id_egypt.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"رقم الإقامة (لغير المصريين)"}),e.jsx(s,{type:"text",...t("residence_number_outside_egypt")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"يُدرّس أونلاين؟"}),e.jsxs("select",{...t("is_online"),className:"w-full border rounded-lg p-2",children:[e.jsx("option",{value:"false",children:"لا"}),e.jsx("option",{value:"true",children:"نعم"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"يُدرّس أوفلاين؟"}),e.jsxs("select",{...t("is_offline"),className:"w-full border rounded-lg p-2",children:[e.jsx("option",{value:"false",children:"لا"}),e.jsx("option",{value:"true",children:"نعم"})]})]}),i===!0&&e.jsxs("div",{className:"col-span-2 flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",...t("home_availability"),className:"w-4 h-4"}),e.jsx("label",{children:"هل متاح التدريس من المنزل؟"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{children:"صورة المعلم"}),e.jsx(s,{type:"file",accept:"image/*",...t("image")})]}),e.jsx("div",{className:"col-span-2 mt-4",children:e.jsx(_,{className:"w-full bg-purple-600 hover:bg-purple-700 text-white text-lg",disabled:c,children:c?"جاري الإضافة...":"تعديل المعلم"})})]})})}function ue(){var H;const[r,g]=y.useState(1),[u,c]=y.useState(""),{data:t,error:v,isLoading:n}=re({page:r,search:u}),[w,m]=y.useState(0),[i]=le(),{data:o,isLoading:a}=ie({page:1,search:""}),d=(o==null?void 0:o.data)??[],p=(d==null?void 0:d.map(l=>{var x;return{value:((x=l.id)==null?void 0:x.toString())||"",label:l.name}}))||[],b=[{value:"EGP",label:"جنيه مصري"},{value:"USD",label:"دولار أمريكي"},{value:"EUR",label:"يورو"},{value:"SAR",label:"ريال سعودي"}],{register:j,handleSubmit:N,control:D}=O(),I=async l=>{var k,q;const x=new FormData;x.append("class_id",String(l.class_id)),x.append("class_price",String(l.class_price)),x.append("currency",l.currency||"EGP");try{await i({id:w,body:x}).unwrap(),f.fire("تم ","تم بنجاح","success")}catch(R){const S=R;f.fire("Error",(q=(k=S==null?void 0:S.data)==null?void 0:k.errors)!=null&&q.name?S.data.errors.name.join(`
`):"Something went wrong","error")}E()},[L,M]=y.useState(!1),[P,$]=y.useState(),[G,B]=y.useState(!1),z=()=>{M(!1)},A=()=>{M(!0)},E=()=>{B(!1)},V=()=>{B(!0)},Q=(t==null?void 0:t.data)??[],W=((H=t==null?void 0:t.meta)==null?void 0:H.total)??0,[J]=ae(),[K,{data:X}]=te();console.log(X);const Y=async l=>{if((await f.fire({title:"هل أنت متأكد؟",text:"لن تتمكن من التراجع عن هذا!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"نعم، احذف",cancelButtonText:"إلغاء",buttonsStyling:!0,reverseButtons:!0})).isConfirmed)try{await J(l).unwrap(),f.fire("تم الحذف!","تم الحذف بنجاح.","success")}catch(k){f.fire("Error",`Something went wrong! ${k} `,"error")}},Z=y.useRef(null),ee=l=>{c(l.target.value)};return n?e.jsx("p",{children:"جاري تحميل البيانات..."}):v?e.jsx("p",{className:"text-red-500",children:"حدث خطأ أثناء جلب البيانات!"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-white/[0.05] dark:bg-white/[0.03]",children:[e.jsx("div",{className:" w-full my-5",children:e.jsx("input",{value:u,onChange:ee,ref:Z,type:"text",placeholder:"Search or type command...",className:"dark:bg-dark-900 h-11 w-full  text-center rounded-lg border border-gray-200 bg-transparent py-2.5 pl-12 pr-14 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-800 dark:bg-gray-90 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 "})}),e.jsxs("div",{className:"max-w-full overflow-x-auto",children:[e.jsxs(ne,{children:[e.jsx(oe,{className:"border-b border-gray-100 dark:border-white/[0.05]",children:e.jsxs(U,{children:[e.jsxs(h,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:["الاسم"," "]}),e.jsx(h,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"رقم المحمول"}),e.jsx(h,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"الصورة"}),e.jsx(h,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"التأكيد"}),e.jsx(h,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"حجز مواد المدرس"}),e.jsx(h,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"تعديل"}),e.jsx(h,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"حذف"})]})}),e.jsx(de,{className:"divide-y divide-gray-100 dark:divide-white/[0.05]",children:Q.map(l=>e.jsxs(U,{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition",children:[e.jsx(h,{className:"px-5 py-4 sm:px-6 text-start text-lg font-medium text-gray-800 dark:text-white",children:l.name}),e.jsx(h,{className:"px-4 py-3 text-gray-600 dark:text-gray-300 text-base",children:l.phone}),e.jsx(h,{className:"px-4 py-3",children:e.jsx("img",{src:l.image_url||`https://ui-avatars.com/api/?name=${l.name}&background=8b5cf6&color=fff`,alt:l.name,className:"w-14 h-14 rounded-full object-cover border"})}),e.jsx(h,{className:"px-4 py-3",children:l.is_confirmed?e.jsx("span",{className:"text-green-600 font-semibold",children:"تم التأكيد"}):e.jsx(_,{className:"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-1",onClick:()=>K(l.id),children:"تأكيد"})}),e.jsx(h,{className:"px-4 py-3",children:e.jsx(_,{className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-1",onClick:()=>{V(),m(l.id)},children:"حجز مواد المدرس"})}),e.jsx(h,{className:"px-4 py-3",children:e.jsx(_,{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-1",onClick:()=>{A(),$(l)},children:"تعديل"})}),e.jsx(h,{className:"px-4 py-3",children:e.jsx(_,{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-1",onClick:()=>Y(l==null?void 0:l.id),children:"حذف"})})]},l.id))})]}),e.jsx(ce,{page:r,SetPage:g,total:W})]})]}),e.jsxs(T,{className:"w-full  lg:w-4/12 xl:w-4/12  h-auto relative  rounded-3xl bg-white  dark:bg-gray-900",isOpen:L,onClose:z,children:[e.jsx("h1",{className:"flex justify-center p-3  text-3xl",children:"تعديل معلم"}),e.jsx(he,{onCloseUp:z,tempCat:P})]}),e.jsxs(T,{className:"w-full max-w-lg h-auto relative rounded-3xl bg-white dark:bg-gray-900 p-6 shadow-lg",isOpen:G,onClose:E,children:[e.jsx("h1",{className:"text-center text-2xl font-bold mb-6",children:"إضافة مادة"}),e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:N(I),children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"اسم النظام التعليمي"}),e.jsx(C,{control:D,name:"class_id",render:({field:l})=>e.jsx(F,{...l,options:p,isClearable:!0,className:"w-full",isLoading:a,placeholder:"اسم النظام التعليمي",onChange:x=>l.onChange((x==null?void 0:x.value)??null),value:p.find(x=>x.value===l.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"سعر المادة"}),e.jsx(s,{type:"text",className:"w-full",...j("class_price",{required:"حقل الاسم مطلوب"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"العملة"}),e.jsx(C,{control:D,name:"currency",render:({field:l})=>e.jsx(F,{...l,options:b,isClearable:!0,className:"w-full",placeholder:"اختر العملة",onChange:x=>l.onChange((x==null?void 0:x.value)??""),value:b.find(x=>x.value===l.value)})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{className:"px-6 py-2",children:"إضافة"})})]})]})]})}function me({onClose:r}){const[g,{isLoading:u}]=xe(),{register:c,handleSubmit:t,watch:v,formState:{errors:n}}=O(),w=String(v("is_offline"))==="true";console.log(w);const m=async i=>{var a;console.log(i);const o=new FormData;o.append("name",i.name),o.append("phone",i.phone||""),i.password&&o.append("password",i.password),o.append("current_workplace",i.current_workplace||""),o.append("specialization",i.specialization),o.append("work_title",i.work_title||""),o.append("phone2",i.phone2||""),o.append("home_address",i.home_address||""),o.append("work_address",i.work_address||""),o.append("country",i.country||""),o.append("city",i.city||""),o.append("district",i.district||""),o.append("desc",i.desc||""),o.append("years_of_experience",String(i.years_of_experience||0)),o.append("national_id_egypt",i.national_id_egypt||""),o.append("residence_number_outside_egypt",i.residence_number_outside_egypt||""),o.append("is_online",i.is_online==="true"?"1":"0"),o.append("is_offline",i.is_offline==="true"?"1":"0"),i.is_offline==="true"?o.append("home_availability",i.home_availability?"1":"0"):o.append("home_availability",i.home_availability="0"),i.image&&i.image[0]&&o.append("image",i.image[0]);try{await g(o).unwrap(),f.fire("تم","تم إضافة المعلم بنجاح","success"),r()}catch(d){const p=d;console.log(p);let b="حدث خطأ ما";(a=p==null?void 0:p.data)!=null&&a.errors&&(typeof p.data.errors=="object"?b=Object.values(p.data.errors).flat().join(`
`):typeof p.data.errors=="string"&&(b=p.data.errors)),f.fire("خطأ",b,"error"),r()}};return e.jsx("div",{className:"max-h-[80vh] overflow-y-auto p-6 rounded-2xl bg-white dark:bg-gray-900 w-full max-w-3xl mx-auto",children:e.jsxs("form",{onSubmit:t(m),className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{children:"الاسم"}),e.jsx(s,{type:"text",...c("name",{required:"الاسم مطلوب"})}),n.name&&e.jsx("p",{className:"text-red-500 text-sm",children:n.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"رقم الهاتف"}),e.jsx(s,{type:"text",...c("phone",{required:"رقم المحمول مطلوب"})}),n.phone&&e.jsx("p",{className:"text-red-500 text-sm",children:n.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"كلمة المرور"}),e.jsx(s,{type:"password",...c("password")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"جهة العمل الحالية"}),e.jsx(s,{type:"text",...c("current_workplace")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"التخصص"}),e.jsx(s,{type:"text",...c("specialization")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"المسمى الوظيفي"}),e.jsx(s,{type:"text",...c("work_title")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"هاتف إضافي"}),e.jsx(s,{type:"text",...c("phone2")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"عنوان السكن"}),e.jsx(s,{type:"text",...c("home_address")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"عنوان العمل"}),e.jsx(s,{type:"text",...c("work_address")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"الدولة"}),e.jsx(s,{type:"text",...c("country")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"المدينة"}),e.jsx(s,{type:"text",...c("city")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"الحى"}),e.jsx(s,{type:"text",...c("district")})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{children:"الوصف"}),e.jsx(s,{className:"h-24",type:"text",...c("desc")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"سنوات الخبرة"}),e.jsx(s,{type:"number",...c("years_of_experience")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"الرقم القومي (للمصريين)"}),e.jsx(s,{type:"text",...c("national_id_egypt",{required:"الرقم القومي مطلوب",pattern:{value:/^\d{14,}$/,message:"الرقم القومي يجب أن يكون 14 رقمًا أو أكثر"}})}),n.national_id_egypt&&e.jsx("p",{className:"text-red-500 text-sm",children:n.national_id_egypt.message}),"        "]}),e.jsxs("div",{children:[e.jsx("label",{children:"رقم الإقامة (لغير المصريين)"}),e.jsx(s,{type:"text",...c("residence_number_outside_egypt")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"يُدرّس أونلاين؟"}),e.jsxs("select",{...c("is_online"),className:"w-full border rounded-lg p-2",children:[e.jsx("option",{value:"false",children:"لا"}),e.jsx("option",{value:"true",children:"نعم"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"يُدرّس أوفلاين؟"}),e.jsxs("select",{...c("is_offline"),className:"w-full border rounded-lg p-2",children:[e.jsx("option",{value:"false",children:"لا"}),e.jsx("option",{value:"true",children:"نعم"})]})]}),w==!0&&e.jsxs("div",{className:"col-span-2 flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",...c("home_availability"),className:"w-4 h-4"}),e.jsx("label",{children:"هل متاح التدريس من المنزل؟"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{children:"صورة المعلم"}),e.jsx(s,{type:"file",accept:"image/*",...c("image")})]}),e.jsx("div",{className:"col-span-2 mt-4",children:e.jsx(_,{className:"w-full bg-purple-600 hover:bg-purple-700 text-white text-lg",disabled:u,children:u?"جاري الإضافة...":"إضافة المعلم"})})]})})}const ge=()=>{const[r,g]=y.useState(!1),u=()=>{g(!1)},c=()=>{g(!0)};return e.jsxs(pe,{onOpen:c,title:"Teatchers",children:[e.jsx(ue,{}),e.jsxs(T,{className:"w-full  lg:w-4/12 xl:w-4/12  h-auto relative  rounded-3xl bg-white  dark:bg-gray-900",isOpen:r,onClose:u,children:[e.jsx("h1",{className:"flex justify-center p-3  text-3xl",children:"اضافة مدرس"}),e.jsx(me,{onClose:u})]})]})};export{ge as default};
