import{$ as k,a as S,r as h,j as e,I as N,B as y,S as f,a0 as F,a1 as H,T as M,d as E,e as v,f as p,g as R,P as L,M as T,a2 as P,C as $}from"./index-De2xroJ3.js";function q({tempCat:s,onCloseUp:d}){const[a,{isLoading:l}]=k(),{register:r,handleSubmit:j,setValue:u,formState:{errors:i}}=S();h.useEffect(()=>{s&&(u("title",s.title||""),u("description",s.description||""))},[u,s]);const x=async n=>{var g,o;const c=new FormData;c.append("title",n.title),c.append("description",n.description||""),n.image&&n.image[0]&&c.append("image",n.image[0]);try{await a({id:Number(s==null?void 0:s.id),body:c}).unwrap(),f.fire("تم","تم تحديث الاستفسار بنجاح","success"),d()}catch(b){console.log(b);const m=b;f.fire("خطأ",(o=(g=m==null?void 0:m.data)==null?void 0:g.errors)!=null&&o.name?m.data.errors.name.join(`
`):"حدث خطأ ما","error")}};return e.jsxs("form",{className:"flex justify-center flex-col my-12 gap-4 p-5 w-full",onSubmit:j(x),children:[e.jsxs("div",{children:[e.jsx("label",{children:"الاسم"}),e.jsx(N,{type:"text",...r("title",{required:"الاسم مطلوب"})}),i.title&&e.jsx("p",{className:"text-red-500 text-sm",children:i.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"رقم الهاتف"}),e.jsx(N,{type:"text",...r("description")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"صورة المعلم"}),e.jsx(N,{type:"file",accept:"image/*",...r("image")})]}),e.jsx("div",{children:e.jsx(y,{className:"w-full text-3xl",disabled:l,children:l?"جاري التحديث...":"تحديث بيانات المعلم"})})]})}function A(){var w;const[s,d]=h.useState(1),[a,l]=h.useState(""),{data:r,error:j,isLoading:u}=F({page:s,search:a}),[i,x]=h.useState(),[n,c]=h.useState(!1),g=(r==null?void 0:r.data)??[],o=((w=r==null?void 0:r.meta)==null?void 0:w.total)??0,[b]=H(),m=()=>{c(!1)},B=()=>{c(!0)},C=async t=>{if((await f.fire({title:"هل أنت متأكد؟",text:"لن تتمكن من التراجع عن هذا!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#9333ea",cancelButtonColor:"#d33",confirmButtonText:"نعم، احذف",cancelButtonText:"إلغاء",buttonsStyling:!0,reverseButtons:!0})).isConfirmed)try{await b(t).unwrap(),f.fire("تم الحذف!","تم حذف الخبر بنجاح.","success")}catch(U){f.fire("خطأ",`حدثت مشكلة! ${U} `,"error")}},O=h.useRef(null),D=t=>{l(t.target.value)};return u?e.jsx("p",{className:"p-6",children:"جاري تحميل البيانات..."}):j?e.jsx("p",{className:"p-6 text-red-500",children:"حدث خطأ أثناء جلب البيانات!"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-4 space-y-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("input",{value:a,onChange:D,ref:O,type:"text",placeholder:"ابحث عن خبر...",className:"w-full h-11 rounded-lg border border-gray-300 px-4 text-sm text-gray-800 shadow-sm focus:border-purple-400 focus:ring focus:ring-purple-100"})}),e.jsxs("div",{className:"max-w-full overflow-x-auto",children:[e.jsxs(M,{children:[e.jsx(E,{children:e.jsxs(v,{className:"bg-gray-50",children:[e.jsx(p,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"الاسم"}),e.jsx(p,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"الوصف"}),e.jsx(p,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"الصورة"}),e.jsx(p,{isHeader:!0,className:"px-5 py-3 font-semibold text-purple-700 text-start",children:"الإجراءات"})]})}),e.jsx(R,{className:"divide-y divide-gray-100",children:g.map(t=>e.jsxs(v,{className:"hover:bg-gray-50",children:[e.jsx(p,{className:"px-5 py-4 font-medium text-gray-800",children:t.title}),e.jsx(p,{className:"px-5 py-4 text-gray-600",children:t.description}),e.jsx(p,{className:"px-5 py-4",children:e.jsx("img",{src:t.image_url||`https://ui-avatars.com/api/?name=${t.title}&background=8b5cf6&color=fff`,alt:t.title,className:"h-16 w-16 object-cover rounded-lg border"})}),e.jsx(p,{className:"px-5 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(y,{className:"bg-purple-600 text-white",onClick:()=>{B(),x(t)},children:"تعديل"}),e.jsx(y,{className:"bg-red-600 text-white",onClick:()=>C(t==null?void 0:t.id),children:"حذف"})]})})]},t.id))})]}),e.jsx("div",{className:"mt-4",children:e.jsx(L,{page:s,SetPage:d,total:o})})]})]}),e.jsxs(T,{className:"w-full lg:w-4/12 xl:w-4/12 h-auto relative rounded-3xl bg-white dark:bg-gray-900",isOpen:n,onClose:m,children:[e.jsx("h1",{className:"flex justify-center p-3 text-xl font-bold text-purple-700",children:"تعديل خبر"}),e.jsx(q,{onCloseUp:m,tempCat:i})]})]})}function G({onClose:s}){const[d,{isLoading:a}]=P(),{register:l,handleSubmit:r,formState:{errors:j}}=S(),u=async i=>{var n,c;const x=new FormData;x.append("title",i.title),x.append("description",i.description||""),i.image&&i.image[0]&&x.append("image",i.image[0]);try{await d(x).unwrap(),f.fire("تم ","تم بنجاح","success")}catch(g){const o=g;f.fire("Error",(c=(n=o==null?void 0:o.data)==null?void 0:n.errors)!=null&&c.name?o.data.errors.name.join(`
`):"Something went wrong","error")}s()};return e.jsxs("form",{className:"flex justify-center flex-col my-12 gap-4 p-5 w-full",onSubmit:r(u),children:[e.jsxs("div",{children:[e.jsx("label",{children:"الاسم"}),e.jsx(N,{type:"text",...l("title",{required:"الاسم مطلوب"})}),j.title&&e.jsx("p",{className:"text-red-500 text-sm",children:j.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:" الوصف"}),e.jsx(N,{type:"text",...l("description")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"صورة الخبر"}),e.jsx(N,{type:"file",accept:"image/*",...l("image")})]}),e.jsx("div",{children:e.jsx(y,{className:"w-full text-3xl",disabled:a,children:a?"جاري التحديث...":"اضافة خبر"})})]})}const _=()=>{const[s,d]=h.useState(!1),a=()=>{d(!1)},l=()=>{d(!0)};return e.jsxs($,{onOpen:l,title:"News",children:[e.jsx(A,{}),e.jsxs(T,{className:"w-full  lg:w-4/12 xl:w-4/12  h-auto relative  rounded-3xl bg-white  dark:bg-gray-900",isOpen:s,onClose:a,children:[e.jsx("h1",{className:"flex justify-center p-3  text-3xl",children:"اضافة خبر"}),e.jsx(G,{onClose:a})]})]})};export{_ as default};
